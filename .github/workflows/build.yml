name: Build Source Engine (WAF)

on: [workflow_dispatch] # Запуск вручну

jobs:
  build-windows:
    runs-on: windows-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          submodules: recursive # Обов'язково для підтягування всіх частин рушія

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: Setup MSVC (Visual Studio Build Tools)
        uses: microsoft/setup-msbuild@v2

      - name: Configure Waf
        # -T release: режим релізу
        # --64bits: якщо хочеш 64-бітну версію (можна прибрати, якщо треба 32)
        run: python waf configure -T release --64bits

      - name: Build with Waf
        run: python waf build

      - name: Upload Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: SourceEngine-Windows-x64
          # Waf зазвичай збирає все в папку 'build'
          path: |
            build/release/*.exe
            build/release/*.dll
            build/release/*.so
            
